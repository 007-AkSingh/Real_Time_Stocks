[0m17:02:02.368127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990AE7D160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990B38C2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019909166E40>]}


============================== 17:02:02.378290 | 6fec609d-7a5d-4b8d-bff5-f151103d3996 ==============================
[0m17:02:02.378290 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:02:02.381044 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\ANIKET\\.dbt', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\ANIKET\\real-time-stocks\\dbt_stocks\\dbt_stocks\\logs'}
[0m17:02:03.337270 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m17:02:03.337270 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m17:02:03.337270 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m17:02:03.604088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fec609d-7a5d-4b8d-bff5-f151103d3996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990E1EC080>]}
[0m17:02:03.661296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fec609d-7a5d-4b8d-bff5-f151103d3996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990B8DBF20>]}
[0m17:02:03.663503 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m17:02:04.382957 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m17:02:04.384462 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:02:04.384462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6fec609d-7a5d-4b8d-bff5-f151103d3996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990E2A5EB0>]}
[0m17:02:07.140484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fec609d-7a5d-4b8d-bff5-f151103d3996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990E8EFA70>]}
[0m17:02:07.203870 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ANIKET\real-time-stocks\dbt_stocks\dbt_stocks\target\manifest.json
[0m17:02:07.248163 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ANIKET\real-time-stocks\dbt_stocks\dbt_stocks\target\semantic_manifest.json
[0m17:02:07.286230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fec609d-7a5d-4b8d-bff5-f151103d3996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990E8CCC20>]}
[0m17:02:07.286230 [info ] [MainThread]: Found 7 models, 4 data tests, 1 source, 479 macros
[0m17:02:07.286230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fec609d-7a5d-4b8d-bff5-f151103d3996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990E94BE60>]}
[0m17:02:07.293403 [info ] [MainThread]: 
[0m17:02:07.297056 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:02:07.299917 [info ] [MainThread]: 
[0m17:02:07.301571 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:02:07.308635 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_STOCKS_MDS'
[0m17:02:10.685146 [debug] [ThreadPool]: Using snowflake connection "list_STOCKS_MDS"
[0m17:02:10.685687 [debug] [ThreadPool]: On list_STOCKS_MDS: show terse schemas in database STOCKS_MDS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_stocks", "target_name": "dev", "connection_name": "list_STOCKS_MDS"} */
[0m17:02:10.686246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:02:11.774261 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.088 seconds
[0m17:02:11.777982 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_STOCKS_MDS_COMMON'
[0m17:02:11.787594 [debug] [ThreadPool]: Using snowflake connection "list_STOCKS_MDS_COMMON"
[0m17:02:11.787594 [debug] [ThreadPool]: On list_STOCKS_MDS_COMMON: show objects in STOCKS_MDS.COMMON
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_stocks", "target_name": "dev", "connection_name": "list_STOCKS_MDS_COMMON"} */;
[0m17:02:11.787594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:02:11.989753 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.200 seconds
[0m17:02:11.992376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fec609d-7a5d-4b8d-bff5-f151103d3996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990E78A240>]}
[0m17:02:12.001928 [debug] [Thread-1 (]: Began running node model.dbt_stocks.bronze_stg_stock_quotes
[0m17:02:12.002450 [debug] [Thread-2 (]: Began running node model.dbt_stocks.my_first_dbt_model
[0m17:02:12.002984 [info ] [Thread-1 (]: 1 of 7 START sql view model COMMON.bronze_stg_stock_quotes ..................... [RUN]
[0m17:02:12.004028 [info ] [Thread-2 (]: 2 of 7 START sql table model COMMON.my_first_dbt_model ......................... [RUN]
[0m17:02:12.007048 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_stocks.bronze_stg_stock_quotes'
[0m17:02:12.009212 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_stocks.my_first_dbt_model'
[0m17:02:12.009729 [debug] [Thread-1 (]: Began compiling node model.dbt_stocks.bronze_stg_stock_quotes
[0m17:02:12.010245 [debug] [Thread-2 (]: Began compiling node model.dbt_stocks.my_first_dbt_model
[0m17:02:12.018819 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stocks.bronze_stg_stock_quotes"
[0m17:02:12.027031 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_stocks.my_first_dbt_model"
[0m17:02:12.030331 [debug] [Thread-1 (]: Began executing node model.dbt_stocks.bronze_stg_stock_quotes
[0m17:02:12.099530 [debug] [Thread-2 (]: Began executing node model.dbt_stocks.my_first_dbt_model
[0m17:02:12.130525 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stocks.bronze_stg_stock_quotes"
[0m17:02:12.158285 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_stocks.my_first_dbt_model"
[0m17:02:12.162629 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stocks.bronze_stg_stock_quotes"
[0m17:02:12.163690 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_stocks.my_first_dbt_model"
[0m17:02:12.164738 [debug] [Thread-1 (]: On model.dbt_stocks.bronze_stg_stock_quotes: create or replace   view STOCKS_MDS.COMMON.bronze_stg_stock_quotes
  
  
  
  
  as (
    SELECT
    v:c::float AS current_price,
    v:d::float AS change_amount,
    v:dp::float AS change_percent,
    v:h::float AS day_high,
    v:l::float AS day_low,
    v:o::float AS day_open,
    v:pc::float AS prev_close,
    v:t::timestamp AS market_timestamp,
    v:symbol::string AS symbol,
    v:fetched_at::timestamp AS fetched_at
FROM STOCKS_MDS.COMMON.bronze_stock_quotes_raw
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_stocks", "target_name": "dev", "node_id": "model.dbt_stocks.bronze_stg_stock_quotes"} */;
[0m17:02:12.165303 [debug] [Thread-2 (]: On model.dbt_stocks.my_first_dbt_model: create or replace transient table STOCKS_MDS.COMMON.my_first_dbt_model
    
    
    
    as (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_stocks", "target_name": "dev", "node_id": "model.dbt_stocks.my_first_dbt_model"} */;
[0m17:02:12.165828 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:02:12.166430 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:02:12.513440 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.347 seconds
[0m17:02:12.536556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fec609d-7a5d-4b8d-bff5-f151103d3996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019908DEE510>]}
[0m17:02:12.537105 [info ] [Thread-1 (]: 1 of 7 OK created sql view model COMMON.bronze_stg_stock_quotes ................ [[32mSUCCESS 1[0m in 0.53s]
[0m17:02:12.538731 [debug] [Thread-1 (]: Finished running node model.dbt_stocks.bronze_stg_stock_quotes
[0m17:02:12.541526 [debug] [Thread-4 (]: Began running node model.dbt_stocks.silver_clean_stock_quotes
[0m17:02:12.542667 [info ] [Thread-4 (]: 3 of 7 START sql view model COMMON.silver_clean_stock_quotes ................... [RUN]
[0m17:02:12.544030 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_stocks.silver_clean_stock_quotes'
[0m17:02:12.545036 [debug] [Thread-4 (]: Began compiling node model.dbt_stocks.silver_clean_stock_quotes
[0m17:02:12.546060 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_stocks.silver_clean_stock_quotes"
[0m17:02:12.546060 [debug] [Thread-4 (]: Began executing node model.dbt_stocks.silver_clean_stock_quotes
[0m17:02:12.551866 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_stocks.silver_clean_stock_quotes"
[0m17:02:12.551866 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_stocks.silver_clean_stock_quotes"
[0m17:02:12.551866 [debug] [Thread-4 (]: On model.dbt_stocks.silver_clean_stock_quotes: create or replace   view STOCKS_MDS.COMMON.silver_clean_stock_quotes
  
  
  
  
  as (
    SELECT
    symbol,
    current_price,
    ROUND(day_high, 2) AS day_high,
    ROUND(day_low, 2) AS day_low,
    ROUND(day_open, 2) AS day_open,
    ROUND(prev_close, 2) AS prev_close,
    change_amount,
    ROUND(change_percent, 4) AS change_percent,
    market_timestamp,
    fetched_at
FROM STOCKS_MDS.COMMON.bronze_stg_stock_quotes
WHERE current_price IS NOT NULL
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_stocks", "target_name": "dev", "node_id": "model.dbt_stocks.silver_clean_stock_quotes"} */;
[0m17:02:12.551866 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:02:12.859883 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.302 seconds
[0m17:02:12.862306 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fec609d-7a5d-4b8d-bff5-f151103d3996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990FF06840>]}
[0m17:02:12.862908 [info ] [Thread-4 (]: 3 of 7 OK created sql view model COMMON.silver_clean_stock_quotes .............. [[32mSUCCESS 1[0m in 0.32s]
[0m17:02:12.863970 [debug] [Thread-4 (]: Finished running node model.dbt_stocks.silver_clean_stock_quotes
[0m17:02:12.866181 [debug] [Thread-1 (]: Began running node model.dbt_stocks.gold_candlestick
[0m17:02:12.866739 [debug] [Thread-3 (]: Began running node model.dbt_stocks.gold_kpi
[0m17:02:12.867270 [debug] [Thread-4 (]: Began running node model.dbt_stocks.gold_treechart
[0m17:02:12.868949 [info ] [Thread-1 (]: 4 of 7 START sql view model COMMON.gold_candlestick ............................ [RUN]
[0m17:02:12.869469 [info ] [Thread-3 (]: 5 of 7 START sql view model COMMON.gold_kpi .................................... [RUN]
[0m17:02:12.870497 [info ] [Thread-4 (]: 6 of 7 START sql view model COMMON.gold_treechart .............................. [RUN]
[0m17:02:12.870497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stocks.bronze_stg_stock_quotes, now model.dbt_stocks.gold_candlestick)
[0m17:02:12.870497 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_stocks.gold_kpi'
[0m17:02:12.872437 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_stocks.silver_clean_stock_quotes, now model.dbt_stocks.gold_treechart)
[0m17:02:12.875160 [debug] [Thread-1 (]: Began compiling node model.dbt_stocks.gold_candlestick
[0m17:02:12.875742 [debug] [Thread-3 (]: Began compiling node model.dbt_stocks.gold_kpi
[0m17:02:12.876317 [debug] [Thread-4 (]: Began compiling node model.dbt_stocks.gold_treechart
[0m17:02:12.881178 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stocks.gold_candlestick"
[0m17:02:12.884333 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_stocks.gold_kpi"
[0m17:02:12.887964 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_stocks.gold_treechart"
[0m17:02:12.890472 [debug] [Thread-4 (]: Began executing node model.dbt_stocks.gold_treechart
[0m17:02:12.890472 [debug] [Thread-1 (]: Began executing node model.dbt_stocks.gold_candlestick
[0m17:02:12.893068 [debug] [Thread-3 (]: Began executing node model.dbt_stocks.gold_kpi
[0m17:02:12.893068 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_stocks.gold_treechart"
[0m17:02:12.893068 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stocks.gold_candlestick"
[0m17:02:12.900738 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_stocks.gold_kpi"
[0m17:02:12.904595 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stocks.gold_candlestick"
[0m17:02:12.904595 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_stocks.gold_treechart"
[0m17:02:12.904595 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_stocks.gold_kpi"
[0m17:02:12.911248 [debug] [Thread-1 (]: On model.dbt_stocks.gold_candlestick: create or replace   view STOCKS_MDS.COMMON.gold_candlestick
  
  
  
  
  as (
    with enriched as (
    select
        symbol,
        cast(market_timestamp as date) as trade_date,
        day_low,
        day_high,
        current_price,
        first_value(current_price) over (
            partition by symbol, cast(market_timestamp as date)
            order by market_timestamp
        ) as candle_open,
        last_value(current_price) over (
            partition by symbol, cast(market_timestamp as date)
            order by market_timestamp
            rows between unbounded preceding and unbounded following
        ) as candle_close
    from STOCKS_MDS.COMMON.silver_clean_stock_quotes
),

candles as (
    select
        symbol,
        trade_date as candle_time,
        min(day_low) as candle_low,
        max(day_high) as candle_high,
        any_value(candle_open) as candle_open,
        any_value(candle_close) as candle_close,
        avg(current_price) as trend_line
    from enriched
    group by symbol, trade_date
),

ranked as (
    select
        c.*,
        row_number() over (
            partition by symbol
            order by candle_time desc
        ) as rn
    from candles c
)

select
    symbol,
    candle_time,
    candle_low,
    candle_high,
    candle_open,
    candle_close,
    trend_line
from ranked
where rn <= 12
order by symbol, candle_time
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_stocks", "target_name": "dev", "node_id": "model.dbt_stocks.gold_candlestick"} */;
[0m17:02:12.911248 [debug] [Thread-4 (]: On model.dbt_stocks.gold_treechart: create or replace   view STOCKS_MDS.COMMON.gold_treechart
  
  
  
  
  as (
    WITH source AS (
  SELECT
    symbol,
    TRY_CAST(current_price AS DOUBLE) AS current_price_dbl,
    market_timestamp
  FROM STOCKS_MDS.COMMON.silver_clean_stock_quotes
  -- optionally filter invalid rows:
  WHERE TRY_CAST(current_price AS DOUBLE) IS NOT NULL
),

latest_day AS (
  -- if market_timestamp is epoch seconds (NUMBER/INT):
  SELECT CAST(TO_TIMESTAMP_LTZ(MAX(market_timestamp)) AS DATE) AS max_day
  FROM source
),

latest_prices AS (
  SELECT
    symbol,
    AVG(current_price_dbl) AS avg_price
  FROM source
  JOIN latest_day ld
    ON CAST(TO_TIMESTAMP_LTZ(market_timestamp) AS DATE) = ld.max_day
  GROUP BY symbol
),

all_time_volatility AS (
  SELECT
    symbol,
    STDDEV_POP(current_price_dbl) AS volatility,             
    CASE
      WHEN AVG(current_price_dbl) = 0 THEN NULL
      ELSE STDDEV_POP(current_price_dbl) / NULLIF(AVG(current_price_dbl), 0)
    END AS relative_volatility
  FROM source
  GROUP BY symbol
)

SELECT
  lp.symbol,
  lp.avg_price,
  v.volatility,
  v.relative_volatility
FROM latest_prices lp
JOIN all_time_volatility v ON lp.symbol = v.symbol
ORDER BY lp.symbol
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_stocks", "target_name": "dev", "node_id": "model.dbt_stocks.gold_treechart"} */;
[0m17:02:12.911248 [debug] [Thread-3 (]: On model.dbt_stocks.gold_kpi: create or replace   view STOCKS_MDS.COMMON.gold_kpi
  
  
  
  
  as (
    select
    symbol,
    current_price,
    change_amount,
    change_percent
from (
    select *,
           row_number() over (partition by symbol order by fetched_at desc) as rn
    from STOCKS_MDS.COMMON.silver_clean_stock_quotes
) t
where rn = 1
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_stocks", "target_name": "dev", "node_id": "model.dbt_stocks.gold_kpi"} */;
[0m17:02:12.911248 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:02:13.128688 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.217 seconds
[0m17:02:13.128688 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fec609d-7a5d-4b8d-bff5-f151103d3996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990E7220C0>]}
[0m17:02:13.128688 [info ] [Thread-4 (]: 6 of 7 OK created sql view model COMMON.gold_treechart ......................... [[32mSUCCESS 1[0m in 0.26s]
[0m17:02:13.128688 [debug] [Thread-4 (]: Finished running node model.dbt_stocks.gold_treechart
[0m17:02:13.139474 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.230 seconds
[0m17:02:13.148258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fec609d-7a5d-4b8d-bff5-f151103d3996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990E728DA0>]}
[0m17:02:13.149906 [info ] [Thread-1 (]: 4 of 7 OK created sql view model COMMON.gold_candlestick ....................... [[32mSUCCESS 1[0m in 0.28s]
[0m17:02:13.152921 [debug] [Thread-1 (]: Finished running node model.dbt_stocks.gold_candlestick
[0m17:02:13.239912 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.326 seconds
[0m17:02:13.241589 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fec609d-7a5d-4b8d-bff5-f151103d3996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990E7238C0>]}
[0m17:02:13.243256 [info ] [Thread-3 (]: 5 of 7 OK created sql view model COMMON.gold_kpi ............................... [[32mSUCCESS 1[0m in 0.37s]
[0m17:02:13.243779 [debug] [Thread-3 (]: Finished running node model.dbt_stocks.gold_kpi
[0m17:02:14.145611 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.985 seconds
[0m17:02:14.145611 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fec609d-7a5d-4b8d-bff5-f151103d3996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990E62F800>]}
[0m17:02:14.145611 [info ] [Thread-2 (]: 2 of 7 OK created sql table model COMMON.my_first_dbt_model .................... [[32mSUCCESS 1[0m in 2.14s]
[0m17:02:14.145611 [debug] [Thread-2 (]: Finished running node model.dbt_stocks.my_first_dbt_model
[0m17:02:14.145611 [debug] [Thread-4 (]: Began running node model.dbt_stocks.my_second_dbt_model
[0m17:02:14.145611 [info ] [Thread-4 (]: 7 of 7 START sql view model COMMON.my_second_dbt_model ......................... [RUN]
[0m17:02:14.145611 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_stocks.gold_treechart, now model.dbt_stocks.my_second_dbt_model)
[0m17:02:14.145611 [debug] [Thread-4 (]: Began compiling node model.dbt_stocks.my_second_dbt_model
[0m17:02:14.173660 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_stocks.my_second_dbt_model"
[0m17:02:14.176451 [debug] [Thread-4 (]: Began executing node model.dbt_stocks.my_second_dbt_model
[0m17:02:14.179914 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_stocks.my_second_dbt_model"
[0m17:02:14.182860 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_stocks.my_second_dbt_model"
[0m17:02:14.183432 [debug] [Thread-4 (]: On model.dbt_stocks.my_second_dbt_model: create or replace   view STOCKS_MDS.COMMON.my_second_dbt_model
  
  
  
  
  as (
    -- Use the `ref` function to select from other models

select *
from STOCKS_MDS.COMMON.my_first_dbt_model
where id = 1
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_stocks", "target_name": "dev", "node_id": "model.dbt_stocks.my_second_dbt_model"} */;
[0m17:02:14.318819 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.135 seconds
[0m17:02:14.321258 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fec609d-7a5d-4b8d-bff5-f151103d3996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990E8DA720>]}
[0m17:02:14.322266 [info ] [Thread-4 (]: 7 of 7 OK created sql view model COMMON.my_second_dbt_model .................... [[32mSUCCESS 1[0m in 0.18s]
[0m17:02:14.322266 [debug] [Thread-4 (]: Finished running node model.dbt_stocks.my_second_dbt_model
[0m17:02:14.325264 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:02:14.325906 [debug] [MainThread]: Connection 'list_STOCKS_MDS' was left open.
[0m17:02:14.325906 [debug] [MainThread]: On list_STOCKS_MDS: Close
[0m17:02:14.372383 [debug] [MainThread]: Connection 'list_STOCKS_MDS_COMMON' was left open.
[0m17:02:14.372383 [debug] [MainThread]: On list_STOCKS_MDS_COMMON: Close
[0m17:02:14.431285 [debug] [MainThread]: Connection 'model.dbt_stocks.gold_candlestick' was left open.
[0m17:02:14.431817 [debug] [MainThread]: On model.dbt_stocks.gold_candlestick: Close
[0m17:02:14.488431 [debug] [MainThread]: Connection 'model.dbt_stocks.my_first_dbt_model' was left open.
[0m17:02:14.488962 [debug] [MainThread]: On model.dbt_stocks.my_first_dbt_model: Close
[0m17:02:14.538347 [debug] [MainThread]: Connection 'model.dbt_stocks.my_second_dbt_model' was left open.
[0m17:02:14.538347 [debug] [MainThread]: On model.dbt_stocks.my_second_dbt_model: Close
[0m17:02:14.592261 [debug] [MainThread]: Connection 'model.dbt_stocks.gold_kpi' was left open.
[0m17:02:14.592814 [debug] [MainThread]: On model.dbt_stocks.gold_kpi: Close
[0m17:02:14.644376 [info ] [MainThread]: 
[0m17:02:14.644376 [info ] [MainThread]: Finished running 1 table model, 6 view models in 0 hours 0 minutes and 7.34 seconds (7.34s).
[0m17:02:14.648481 [debug] [MainThread]: Command end result
[0m17:02:14.673364 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ANIKET\real-time-stocks\dbt_stocks\dbt_stocks\target\manifest.json
[0m17:02:14.673364 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ANIKET\real-time-stocks\dbt_stocks\dbt_stocks\target\semantic_manifest.json
[0m17:02:14.683786 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ANIKET\real-time-stocks\dbt_stocks\dbt_stocks\target\run_results.json
[0m17:02:14.683786 [info ] [MainThread]: 
[0m17:02:14.683786 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:02:14.683786 [info ] [MainThread]: 
[0m17:02:14.683786 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m17:02:14.683786 [debug] [MainThread]: Command `dbt run` succeeded at 17:02:14.683786 after 12.53 seconds
[0m17:02:14.683786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990B2C4B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990B913C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990B912570>]}
[0m17:02:14.683786 [debug] [MainThread]: Flushing usage events
[0m17:02:16.351967 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:37:01.265198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA408F3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA3C83620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA1322A20>]}


============================== 19:37:01.275678 | 572b5e0b-aa68-448d-b8ee-9a85060342a5 ==============================
[0m19:37:01.275678 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:37:01.278312 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\ANIKET\\.dbt', 'use_colors': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\ANIKET\\real-time-stocks\\dbt_stocks\\dbt_stocks\\logs'}
[0m19:37:02.622862 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m19:37:02.622862 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m19:37:02.622862 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m19:37:03.042633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '572b5e0b-aa68-448d-b8ee-9a85060342a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA46501A0>]}
[0m19:37:03.167021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '572b5e0b-aa68-448d-b8ee-9a85060342a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA4194950>]}
[0m19:37:03.171597 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m19:37:03.985038 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:37:04.897018 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:37:04.897018 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:37:04.959339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '572b5e0b-aa68-448d-b8ee-9a85060342a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA7227050>]}
[0m19:37:05.064506 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ANIKET\real-time-stocks\dbt_stocks\dbt_stocks\target\manifest.json
[0m19:37:05.068161 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ANIKET\real-time-stocks\dbt_stocks\dbt_stocks\target\semantic_manifest.json
[0m19:37:05.140028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '572b5e0b-aa68-448d-b8ee-9a85060342a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA7542930>]}
[0m19:37:05.140028 [info ] [MainThread]: Found 7 models, 4 data tests, 1 source, 479 macros
[0m19:37:05.142622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '572b5e0b-aa68-448d-b8ee-9a85060342a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA71F8B90>]}
[0m19:37:05.147617 [info ] [MainThread]: 
[0m19:37:05.150952 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:37:05.156991 [info ] [MainThread]: 
[0m19:37:05.159912 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:37:05.168418 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_STOCKS_MDS'
[0m19:37:07.174061 [debug] [ThreadPool]: Using snowflake connection "list_STOCKS_MDS"
[0m19:37:07.174061 [debug] [ThreadPool]: On list_STOCKS_MDS: show terse schemas in database STOCKS_MDS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_stocks", "target_name": "dev", "connection_name": "list_STOCKS_MDS"} */
[0m19:37:07.174061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:08.098055 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.929 seconds
[0m19:37:08.108733 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_STOCKS_MDS_COMMON'
[0m19:37:08.120524 [debug] [ThreadPool]: Using snowflake connection "list_STOCKS_MDS_COMMON"
[0m19:37:08.120524 [debug] [ThreadPool]: On list_STOCKS_MDS_COMMON: show objects in STOCKS_MDS.COMMON
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_stocks", "target_name": "dev", "connection_name": "list_STOCKS_MDS_COMMON"} */;
[0m19:37:08.120524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:08.491190 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.369 seconds
[0m19:37:08.493196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '572b5e0b-aa68-448d-b8ee-9a85060342a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA738CC80>]}
[0m19:37:08.504372 [debug] [Thread-1 (]: Began running node model.dbt_stocks.bronze_stg_stock_quotes
[0m19:37:08.504372 [debug] [Thread-2 (]: Began running node model.dbt_stocks.my_first_dbt_model
[0m19:37:08.504372 [info ] [Thread-1 (]: 1 of 7 START sql view model COMMON.bronze_stg_stock_quotes ..................... [RUN]
[0m19:37:08.511635 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_stocks.bronze_stg_stock_quotes'
[0m19:37:08.508487 [info ] [Thread-2 (]: 2 of 7 START sql table model COMMON.my_first_dbt_model ......................... [RUN]
[0m19:37:08.511635 [debug] [Thread-1 (]: Began compiling node model.dbt_stocks.bronze_stg_stock_quotes
[0m19:37:08.511635 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_stocks.my_first_dbt_model'
[0m19:37:08.521754 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stocks.bronze_stg_stock_quotes"
[0m19:37:08.521754 [debug] [Thread-2 (]: Began compiling node model.dbt_stocks.my_first_dbt_model
[0m19:37:08.532562 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_stocks.my_first_dbt_model"
[0m19:37:08.533270 [debug] [Thread-1 (]: Began executing node model.dbt_stocks.bronze_stg_stock_quotes
[0m19:37:08.540666 [debug] [Thread-2 (]: Began executing node model.dbt_stocks.my_first_dbt_model
[0m19:37:08.566332 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stocks.bronze_stg_stock_quotes"
[0m19:37:08.589857 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_stocks.my_first_dbt_model"
[0m19:37:08.589857 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stocks.bronze_stg_stock_quotes"
[0m19:37:08.594474 [debug] [Thread-1 (]: On model.dbt_stocks.bronze_stg_stock_quotes: create or replace   view STOCKS_MDS.COMMON.bronze_stg_stock_quotes
  
  
  
  
  as (
    SELECT
    v:c::float AS current_price,
    v:d::float AS change_amount,
    v:dp::float AS change_percent,
    v:h::float AS day_high,
    v:l::float AS day_low,
    v:o::float AS day_open,
    v:pc::float AS prev_close,
    v:t::timestamp AS market_timestamp,
    v:symbol::string AS symbol,
    v:fetched_at::timestamp AS fetched_at
FROM STOCKS_MDS.COMMON.bronze_stock_quotes_raw
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_stocks", "target_name": "dev", "node_id": "model.dbt_stocks.bronze_stg_stock_quotes"} */;
[0m19:37:08.594474 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_stocks.my_first_dbt_model"
[0m19:37:08.594474 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:37:08.594474 [debug] [Thread-2 (]: On model.dbt_stocks.my_first_dbt_model: create or replace transient table STOCKS_MDS.COMMON.my_first_dbt_model
    
    
    
    as (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_stocks", "target_name": "dev", "node_id": "model.dbt_stocks.my_first_dbt_model"} */;
[0m19:37:08.594474 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:37:10.027426 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.431 seconds
[0m19:37:10.058594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '572b5e0b-aa68-448d-b8ee-9a85060342a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA1CBE6C0>]}
[0m19:37:10.058594 [info ] [Thread-1 (]: 1 of 7 OK created sql view model COMMON.bronze_stg_stock_quotes ................ [[32mSUCCESS 1[0m in 1.55s]
[0m19:37:10.061633 [debug] [Thread-1 (]: Finished running node model.dbt_stocks.bronze_stg_stock_quotes
[0m19:37:10.064703 [debug] [Thread-4 (]: Began running node model.dbt_stocks.silver_clean_stock_quotes
[0m19:37:10.067346 [info ] [Thread-4 (]: 3 of 7 START sql view model COMMON.silver_clean_stock_quotes ................... [RUN]
[0m19:37:10.067346 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_stocks.silver_clean_stock_quotes'
[0m19:37:10.071413 [debug] [Thread-4 (]: Began compiling node model.dbt_stocks.silver_clean_stock_quotes
[0m19:37:10.076601 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_stocks.silver_clean_stock_quotes"
[0m19:37:10.078610 [debug] [Thread-4 (]: Began executing node model.dbt_stocks.silver_clean_stock_quotes
[0m19:37:10.083200 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_stocks.silver_clean_stock_quotes"
[0m19:37:10.086282 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_stocks.silver_clean_stock_quotes"
[0m19:37:10.086282 [debug] [Thread-4 (]: On model.dbt_stocks.silver_clean_stock_quotes: create or replace   view STOCKS_MDS.COMMON.silver_clean_stock_quotes
  
  
  
  
  as (
    SELECT
    symbol,
    current_price,
    ROUND(day_high, 2) AS day_high,
    ROUND(day_low, 2) AS day_low,
    ROUND(day_open, 2) AS day_open,
    ROUND(prev_close, 2) AS prev_close,
    change_amount,
    ROUND(change_percent, 4) AS change_percent,
    market_timestamp,
    fetched_at
FROM STOCKS_MDS.COMMON.bronze_stg_stock_quotes
WHERE current_price IS NOT NULL
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_stocks", "target_name": "dev", "node_id": "model.dbt_stocks.silver_clean_stock_quotes"} */;
[0m19:37:10.086282 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:37:10.644470 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.558 seconds
[0m19:37:10.644470 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '572b5e0b-aa68-448d-b8ee-9a85060342a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA71696A0>]}
[0m19:37:10.644470 [info ] [Thread-4 (]: 3 of 7 OK created sql view model COMMON.silver_clean_stock_quotes .............. [[32mSUCCESS 1[0m in 0.58s]
[0m19:37:10.651448 [debug] [Thread-4 (]: Finished running node model.dbt_stocks.silver_clean_stock_quotes
[0m19:37:10.654948 [debug] [Thread-1 (]: Began running node model.dbt_stocks.gold_candlestick
[0m19:37:10.654948 [debug] [Thread-3 (]: Began running node model.dbt_stocks.gold_kpi
[0m19:37:10.656322 [debug] [Thread-4 (]: Began running node model.dbt_stocks.gold_treechart
[0m19:37:10.656322 [info ] [Thread-1 (]: 4 of 7 START sql view model COMMON.gold_candlestick ............................ [RUN]
[0m19:37:10.657874 [info ] [Thread-3 (]: 5 of 7 START sql view model COMMON.gold_kpi .................................... [RUN]
[0m19:37:10.661072 [info ] [Thread-4 (]: 6 of 7 START sql view model COMMON.gold_treechart .............................. [RUN]
[0m19:37:10.667919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stocks.bronze_stg_stock_quotes, now model.dbt_stocks.gold_candlestick)
[0m19:37:10.669893 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.dbt_stocks.gold_kpi'
[0m19:37:10.671032 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_stocks.silver_clean_stock_quotes, now model.dbt_stocks.gold_treechart)
[0m19:37:10.671562 [debug] [Thread-1 (]: Began compiling node model.dbt_stocks.gold_candlestick
[0m19:37:10.673852 [debug] [Thread-3 (]: Began compiling node model.dbt_stocks.gold_kpi
[0m19:37:10.673852 [debug] [Thread-4 (]: Began compiling node model.dbt_stocks.gold_treechart
[0m19:37:10.676815 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stocks.gold_candlestick"
[0m19:37:10.683463 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_stocks.gold_kpi"
[0m19:37:10.683463 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_stocks.gold_treechart"
[0m19:37:10.687835 [debug] [Thread-3 (]: Began executing node model.dbt_stocks.gold_kpi
[0m19:37:10.692903 [debug] [Thread-1 (]: Began executing node model.dbt_stocks.gold_candlestick
[0m19:37:10.692903 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_stocks.gold_kpi"
[0m19:37:10.697765 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stocks.gold_candlestick"
[0m19:37:10.698781 [debug] [Thread-4 (]: Began executing node model.dbt_stocks.gold_treechart
[0m19:37:10.698781 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_stocks.gold_treechart"
[0m19:37:10.698781 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_stocks.gold_kpi"
[0m19:37:10.707881 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_stocks.gold_treechart"
[0m19:37:10.709550 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stocks.gold_candlestick"
[0m19:37:10.710267 [debug] [Thread-3 (]: On model.dbt_stocks.gold_kpi: create or replace   view STOCKS_MDS.COMMON.gold_kpi
  
  
  
  
  as (
    select
    symbol,
    current_price,
    change_amount,
    change_percent
from (
    select *,
           row_number() over (partition by symbol order by fetched_at desc) as rn
    from STOCKS_MDS.COMMON.silver_clean_stock_quotes
) t
where rn = 1
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_stocks", "target_name": "dev", "node_id": "model.dbt_stocks.gold_kpi"} */;
[0m19:37:10.710267 [debug] [Thread-4 (]: On model.dbt_stocks.gold_treechart: create or replace   view STOCKS_MDS.COMMON.gold_treechart
  
  
  
  
  as (
    WITH source AS (
  SELECT
    symbol,
    TRY_CAST(current_price AS DOUBLE) AS current_price_dbl,
    market_timestamp
  FROM STOCKS_MDS.COMMON.silver_clean_stock_quotes
  -- optionally filter invalid rows:
  WHERE TRY_CAST(current_price AS DOUBLE) IS NOT NULL
),

latest_day AS (
  -- if market_timestamp is epoch seconds (NUMBER/INT):
  SELECT CAST(TO_TIMESTAMP_LTZ(MAX(market_timestamp)) AS DATE) AS max_day
  FROM source
),

latest_prices AS (
  SELECT
    symbol,
    AVG(current_price_dbl) AS avg_price
  FROM source
  JOIN latest_day ld
    ON CAST(TO_TIMESTAMP_LTZ(market_timestamp) AS DATE) = ld.max_day
  GROUP BY symbol
),

all_time_volatility AS (
  SELECT
    symbol,
    STDDEV_POP(current_price_dbl) AS volatility,             
    CASE
      WHEN AVG(current_price_dbl) = 0 THEN NULL
      ELSE STDDEV_POP(current_price_dbl) / NULLIF(AVG(current_price_dbl), 0)
    END AS relative_volatility
  FROM source
  GROUP BY symbol
)

SELECT
  lp.symbol,
  lp.avg_price,
  v.volatility,
  v.relative_volatility
FROM latest_prices lp
JOIN all_time_volatility v ON lp.symbol = v.symbol
ORDER BY lp.symbol
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_stocks", "target_name": "dev", "node_id": "model.dbt_stocks.gold_treechart"} */;
[0m19:37:10.710267 [debug] [Thread-1 (]: On model.dbt_stocks.gold_candlestick: create or replace   view STOCKS_MDS.COMMON.gold_candlestick
  
  
  
  
  as (
    with enriched as (
    select
        symbol,
        cast(market_timestamp as date) as trade_date,
        day_low,
        day_high,
        current_price,
        first_value(current_price) over (
            partition by symbol, cast(market_timestamp as date)
            order by market_timestamp
        ) as candle_open,
        last_value(current_price) over (
            partition by symbol, cast(market_timestamp as date)
            order by market_timestamp
            rows between unbounded preceding and unbounded following
        ) as candle_close
    from STOCKS_MDS.COMMON.silver_clean_stock_quotes
),

candles as (
    select
        symbol,
        trade_date as candle_time,
        min(day_low) as candle_low,
        max(day_high) as candle_high,
        any_value(candle_open) as candle_open,
        any_value(candle_close) as candle_close,
        avg(current_price) as trend_line
    from enriched
    group by symbol, trade_date
),

ranked as (
    select
        c.*,
        row_number() over (
            partition by symbol
            order by candle_time desc
        ) as rn
    from candles c
)

select
    symbol,
    candle_time,
    candle_low,
    candle_high,
    candle_open,
    candle_close,
    trend_line
from ranked
where rn <= 12
order by symbol, candle_time
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_stocks", "target_name": "dev", "node_id": "model.dbt_stocks.gold_candlestick"} */;
[0m19:37:10.710267 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:37:10.916225 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.317 seconds
[0m19:37:10.916225 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '572b5e0b-aa68-448d-b8ee-9a85060342a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA7A7E0F0>]}
[0m19:37:10.916225 [info ] [Thread-2 (]: 2 of 7 OK created sql table model COMMON.my_first_dbt_model .................... [[32mSUCCESS 1[0m in 2.40s]
[0m19:37:10.922377 [debug] [Thread-2 (]: Finished running node model.dbt_stocks.my_first_dbt_model
[0m19:37:10.925791 [debug] [Thread-2 (]: Began running node model.dbt_stocks.my_second_dbt_model
[0m19:37:10.925791 [info ] [Thread-2 (]: 7 of 7 START sql view model COMMON.my_second_dbt_model ......................... [RUN]
[0m19:37:10.925791 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_stocks.my_first_dbt_model, now model.dbt_stocks.my_second_dbt_model)
[0m19:37:10.930691 [debug] [Thread-2 (]: Began compiling node model.dbt_stocks.my_second_dbt_model
[0m19:37:10.937154 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_stocks.my_second_dbt_model"
[0m19:37:10.937154 [debug] [Thread-2 (]: Began executing node model.dbt_stocks.my_second_dbt_model
[0m19:37:10.945978 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_stocks.my_second_dbt_model"
[0m19:37:10.947492 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_stocks.my_second_dbt_model"
[0m19:37:10.947492 [debug] [Thread-2 (]: On model.dbt_stocks.my_second_dbt_model: create or replace   view STOCKS_MDS.COMMON.my_second_dbt_model
  
  
  
  
  as (
    -- Use the `ref` function to select from other models

select *
from STOCKS_MDS.COMMON.my_first_dbt_model
where id = 1
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_stocks", "target_name": "dev", "node_id": "model.dbt_stocks.my_second_dbt_model"} */;
[0m19:37:10.947492 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.239 seconds
[0m19:37:10.954288 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '572b5e0b-aa68-448d-b8ee-9a85060342a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA8BF4110>]}
[0m19:37:10.954288 [info ] [Thread-4 (]: 6 of 7 OK created sql view model COMMON.gold_treechart ......................... [[32mSUCCESS 1[0m in 0.28s]
[0m19:37:10.957812 [debug] [Thread-4 (]: Finished running node model.dbt_stocks.gold_treechart
[0m19:37:10.983757 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.274 seconds
[0m19:37:10.988854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '572b5e0b-aa68-448d-b8ee-9a85060342a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA8C15AC0>]}
[0m19:37:10.988854 [info ] [Thread-1 (]: 4 of 7 OK created sql view model COMMON.gold_candlestick ....................... [[32mSUCCESS 1[0m in 0.32s]
[0m19:37:10.992737 [debug] [Thread-1 (]: Finished running node model.dbt_stocks.gold_candlestick
[0m19:37:11.082000 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.371 seconds
[0m19:37:11.086016 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '572b5e0b-aa68-448d-b8ee-9a85060342a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA8C04B00>]}
[0m19:37:11.086016 [info ] [Thread-3 (]: 5 of 7 OK created sql view model COMMON.gold_kpi ............................... [[32mSUCCESS 1[0m in 0.42s]
[0m19:37:11.090073 [debug] [Thread-3 (]: Finished running node model.dbt_stocks.gold_kpi
[0m19:37:11.100274 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.149 seconds
[0m19:37:11.106641 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '572b5e0b-aa68-448d-b8ee-9a85060342a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA71696A0>]}
[0m19:37:11.106641 [info ] [Thread-2 (]: 7 of 7 OK created sql view model COMMON.my_second_dbt_model .................... [[32mSUCCESS 1[0m in 0.18s]
[0m19:37:11.108654 [debug] [Thread-2 (]: Finished running node model.dbt_stocks.my_second_dbt_model
[0m19:37:11.115555 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:37:11.117419 [debug] [MainThread]: Connection 'list_STOCKS_MDS' was left open.
[0m19:37:11.117419 [debug] [MainThread]: On list_STOCKS_MDS: Close
[0m19:37:11.178160 [debug] [MainThread]: Connection 'list_STOCKS_MDS_COMMON' was left open.
[0m19:37:11.179268 [debug] [MainThread]: On list_STOCKS_MDS_COMMON: Close
[0m19:37:11.242677 [debug] [MainThread]: Connection 'model.dbt_stocks.gold_candlestick' was left open.
[0m19:37:11.243296 [debug] [MainThread]: On model.dbt_stocks.gold_candlestick: Close
[0m19:37:11.299472 [debug] [MainThread]: Connection 'model.dbt_stocks.my_second_dbt_model' was left open.
[0m19:37:11.300479 [debug] [MainThread]: On model.dbt_stocks.my_second_dbt_model: Close
[0m19:37:11.341788 [debug] [MainThread]: Connection 'model.dbt_stocks.gold_treechart' was left open.
[0m19:37:11.341788 [debug] [MainThread]: On model.dbt_stocks.gold_treechart: Close
[0m19:37:11.409032 [debug] [MainThread]: Connection 'model.dbt_stocks.gold_kpi' was left open.
[0m19:37:11.409612 [debug] [MainThread]: On model.dbt_stocks.gold_kpi: Close
[0m19:37:11.461578 [info ] [MainThread]: 
[0m19:37:11.461578 [info ] [MainThread]: Finished running 1 table model, 6 view models in 0 hours 0 minutes and 6.30 seconds (6.30s).
[0m19:37:11.470128 [debug] [MainThread]: Command end result
[0m19:37:11.497964 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\ANIKET\real-time-stocks\dbt_stocks\dbt_stocks\target\manifest.json
[0m19:37:11.504430 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\ANIKET\real-time-stocks\dbt_stocks\dbt_stocks\target\semantic_manifest.json
[0m19:37:11.508050 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\ANIKET\real-time-stocks\dbt_stocks\dbt_stocks\target\run_results.json
[0m19:37:11.508050 [info ] [MainThread]: 
[0m19:37:11.515142 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:37:11.518226 [info ] [MainThread]: 
[0m19:37:11.521135 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m19:37:11.521135 [debug] [MainThread]: Command `dbt run` succeeded at 19:37:11.521135 after 10.77 seconds
[0m19:37:11.526001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA4FA2F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA47E3C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA47E1700>]}
[0m19:37:11.527294 [debug] [MainThread]: Flushing usage events
[0m19:37:13.621117 [debug] [MainThread]: An error was encountered while trying to flush usage events
